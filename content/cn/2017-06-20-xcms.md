---
title: XCMS 包参数及优化
author: ''
date: '2017-06-20'
slug: xcms
categories: []
tags: []
show_toc: yes
---


## 1.几点说明
1. 我在代谢数据前处理过程中发现 XCMS 的参数优化非常重要（比想象中的要重要的多，这个我会在另一篇博文里专门提出来）。这也是我写这篇博文的主要原因。

2. IPO 或许是一个不错的 XCMS 参数优化的 R 软件包 （我说“或许”是因为我并不熟悉 IPO，试过几次，但因为运行时间过长无果而终）。


3. 我不是 XCMS 方面的专家，为了获得更精确的信息，个人建议参考 XCMS 的官方文档。这里有份 [PPT 文档](http://workflow4metabolomics.org/sites/workflow4metabolomics.org/files/w4e2017-EC_MSprocessing_LC-MS-2017.pdf)，里面对 XCMS 的参数有十分清楚的介绍，是份不错的参考资料。我的这篇博文 90% 的内容是参考了 [stanstrup 的 XCMS 教程](https://github.com/stanstrup/XCMS-course)。

## 2.关于 XCMS

使用或者学习 XCMS 的人对它应该都有基本的了解，所以我就直奔主题，不花笔墨介绍它了。XCMS 数据处理步骤及对应代码如下[^1]：

### 3.0 准备

### 3.1 提取（Extraction）    

***
这个步骤对应上图中的 `Filter and Idenfity Peak - 过滤和峰检测`, 有两种方法：     

> `MatchedFilter` ： 适用于 profile 或者 centroid 模式的低分辨率数据    
> `Centwave`：适用于 centroid 模式的高分辨数据    

因为我用到的都是高分辨数据，所以下面我只专注 Centwave 方法（关于profile 和 centroid模式的区别，可以参考[我的这篇博文](16)）   

示例代码如下：
```(r)
xs = xcmsSet(inputFiles, method = 'centWave', ppm = 15, snthresh = 10, mzdiff = 0.01,
             peakwidth = c(5,20), prefilter = c(7,0))
```     
其中 ppm 和 peakwidth 为两个很重要的参数：  

`ppm`： 连续扫描中 m/z 的最大耐受偏差 - maxmial tolerated m/z deviation in consecutive scans, in ppm
`peakwidth`：色谱峰宽 - chromatographic peak width, given as range (min,max) in seconds 

### 3.2 



{{% alert note %}}
Now is a good time to re-read about `blogdown::serve_site()` and [how _LiveReload_ works](https://bookdown.org/yihui/blogdown/a-quick-example.html) (and how it blocks your R console by default)
{{% /alert %}}











[^1]:XCMS 软件包近期有了较大的升级 但目前并不影响 XCMS 的使用。有时间我会写一篇 XCMS 和 XCMS3 对比的博文。




