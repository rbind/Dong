---
title: 化学计量学里的 S-plot
author: ''
date: '2014-04-30'
slug: s-plot
categories: []
tags:
  - 数据处理
---

我经常会碰到有人问 S plo t的问题，比如：        

>1. 我的 S-plot 为不是 S 型( or 为什么是一条直线)？
>2. S-plot 只能在 OPLS-DA 里面用吧？
>3. S-plot 是不是 score plot？  
>...    

说实话，我自己以前从没听说过 S-plot。不过找到了一篇文献，里面详细讲到了这个概念，所以借此记录一下。

**1.什么是 S-plot？**  

>The S-plot is proposed as a tool for visualization and interpretation of multivariate classification models, e.g., OPLS discriminate analysis, having two or more classes. The S-plot visualizes both the covariance and correlation between metabolites and the modeled class designation. Thereby the S-plot helps identifying statistically significant and potentially biochemically significant metabololites, based on contribution to the model and their reliability.  

S-plot 是用来可视化和解释多元分类模型的方法。它可视化了代谢物与模型所指定的类型的协方差和相关系数。根据代谢物对模型的贡献大小与可信度，S-plot 可以用来帮助我们筛选鉴定统计学上显著和生化学上潜在显著的代谢物。  

说得更清楚些：S-plot 可视化了变量对模型的影响。S-plot 是一个散点图，图中结合了基于投影模型 (projection-based model) 得到的协方差与相关性。协方差给出来对模型的贡献，相关性给出来可信度。  

文中给出的计算方法如下：    

$$Cov(t,X_{i})=\frac{t^TX_{i}}{N-1}$$
$$Corr(t,X_{i})=\frac{Cov(t,X_{i})}{s_{t}s_{Xi}})$$ 

其中$t$得分向量, $X_{i}$是中心化后的数据矩阵，$s$是标准方差。   

S-plot 中，协方差为 x 轴，相关系数为 y 轴。除了变量的方差相同的情况下，S-plot 为 S 型。  
翻了一下文章的 support information，里面给了另一种形式： 

$$Cov(t,X_{i})=\frac{t^TX_{i}}{t^Tt}$$

$$Corr(t,X_{i})=\frac{t^TX_{i}}{\parallel(t)\parallel*\parallel(X_{i})\parallel}$$ 

**2. S-plot 怎么用？**  

了解了上面 S-plot 是什么以后，用起来就很简单了。简单的说，就是高协方差，高相关系数的代谢物就是大家所感兴趣的（因为相关性越高，说明结果的可信度越高，协方差越高，说明所观测到的贡献是来源于数据波动或者噪音的可能性就越小）。而这些感兴趣东西刚好在 S-plot 的两端。所以我们就可以着重研究这些两头的代谢物了。  

![S-plot](http://i.imgur.com/z1YHVpH.jpg)

***
了解这些后，上面问到的问题也就简单了： 

1. S-plot 一般是 S 型，但也不一定
2. S-plot 可以在用在基于投影的模型里，不仅仅是0PLS, 比如 PCA，PLS 也行
3. S-plot 不是 score plot
4. S-plot 不是用来衡量模型好坏的方法  

文章链接[这里](http://pubs.acs.org/doi/abs/10.1021/ac0713510)
***